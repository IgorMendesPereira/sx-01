<!DOCTYPE html>
<html>

<head>
  <title>Soil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:,">
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
  <h1>%NOME%</h1>
  <p>Estado Atual: <span class="reading"><span id="sent">%SENTIDO%</span></span> <span class="reading"><span id="ag">%SECO%</span></span> <span class="reading"><span id="liga">%LIGADO%</span></span>       
  <p>Percentimetro: <span class="reading"><span id="perc">%PERC%</span>&#37;</span></p>
  <p>Posicao: <span class="reading"><span id="angulo">%ANG%</span>&deg;</span></p>
  <div id="idgrafico" class="" style=--radius:%ANG%></div>

  <form action="/get" target="hidden-form" class="atua-form">
    <fieldset class="radio-image">
      <label for="play">
          <input type="radio" name="Estado" id="play" value="1">
          <img src="/play.png" alt="play" width="50%" height="50%">
      </label>
      <label for="stop">
          <input type="radio" name="Estado" id="stop" value="2">
          <img src="/stop.png" alt="stop" width="50%" height="50%">
      </label>
      <br>
      
      <label for="av">
        <input type="radio" name="sentido" id="av" value="3">
        <img src="/rotate_right_small.png" alt="av" width="50%" height="50%">
      </label>
      <label for="rv">
        <input type="radio" name="sentido" id="rv" value="4">
        <img src="/rotate_left_small.png" alt="rv" width="50%" height="50%">
      </label>
      <br>
    
      <label for="sec">
        <input type="radio" name="seco" id="sec" value="5">
        <img src="/water_off.png" alt="seco" width="50%" height="50%">
      </label>
      <label for="mol">
        <input type="radio" name="seco" id="mol" value="6">
        <img src="/water_on.png" alt="molhado" width="50%" height="50%">
      </label>
  </fieldset>
<br>

    Percentimetro <input type="number" step="1" min="0" max="100" name="percentimetro" value="%PERCENTIMETRO%"><br>
    <br>
    <input type="submit" value="Confirmar" class="button button" onclick="submitMessage()">
  </form><br>
  <a href="/agen"><button class="button buttonag">Agendamento</button></a>
  <hr color="gray">
  <!--
  <div>
    <img src="logo_irrigabras.png" alt="logo_irrigabras" width=500% height=100%>
  </div><br>
-->
  <div id='Powered'>
   
    <img class="logosoil" src="logo_soil.png" alt="thsetser" width=136 height=120>

  </div>
  <script>

    var teste
    if (!!window.EventSource) {
      var source = new EventSource('/events');
      source.addEventListener('open', function (e) {
        console.log("Events Connected");
      }, false);
      source.addEventListener('error', function (e) {
        if (e.target.readyState != EventSource.OPEN) {
          console.log("Events Disconnected");
        }
      }, false);

      source.addEventListener('message', function (e) {
        console.log("message", e.data);
      }, false);

      source.addEventListener('sentido', function (e) {
        console.log("sentido", e.data);
        document.getElementById("sent").innerHTML = e.data;
      }, false);

      source.addEventListener('seco', function (e) {
        console.log("seco", e.data);
        document.getElementById("ag").innerHTML = e.data;
      }, false);

      source.addEventListener('ligado', function (e) {
        console.log("ligado", e.data);
        document.getElementById("liga").innerHTML = e.data;
      }, false);

      source.addEventListener('STRperc', function (e) {
        console.log("percentimetro", e.data);
        document.getElementById("perc").innerHTML = e.data;
      }, false);

      //source.addEventListener('hora', function (e) {
      //  console.log("hora", e.data);
      //  document.getElementById("hora").innerHTML = e.data;
      //}, false);
      source.addEventListener('angulo', function (e) {
        console.log("angulo", e.data);
        
        document.getElementById("angulo").innerHTML = e.data;
      }, false);
      //source.addEventListener('rssi', function (e) {
      //  console.log("rssi", e.data);
     //}, false);
    }

    var idgrafico = document.getElementById("idgrafico");
    //var permissoesLogin = window.prompt('csk')
    var sentido = document.getElementById("sent").innerHTML;
    var agua = document.getElementById("ag").innerHTML;

    if (sentido == "Avanco" && agua == "Molhado") {
      idgrafico.className = "avancoligado";

    } else if (sentido == "Avanco" && agua == "Seco") {
      idgrafico.className = "avancodesligado";

    } else if (sentido == "Reverso" && agua == "Molhado") {
      idgrafico.className = "reversoligado";

    } else if (sentido == "Reverso" && agua == "Seco") {
      idgrafico.className = "reversodesligado";

    }
    else {
    }

    function submitMessage() {
      setTimeout(function(){ document.location.reload(); }, 4100);
    }

    


  </script>
  <iframe style="display:none" name="hidden-form"></iframe>
</body>

</html>